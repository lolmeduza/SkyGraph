* { box-sizing: border-box; }
body { margin: 0; font-family: var(--vscode-font-family); font-size: var(--vscode-font-size); position: relative; }

/* === –ê–Ω–∏–º–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è: –∑–≤—ë–∑–¥–Ω–æ–µ –Ω–µ–±–æ === */
.starfield-overlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  transition: opacity 0.9s ease-out;
}
.starfield-overlay.starfield-out {
  opacity: 0;
  pointer-events: none;
}
.starfield-bg {
  position: absolute;
  inset: 0;
  background: radial-gradient(ellipse 120% 80% at 50% 20%, #1a0a2e 0%, #0d0221 35%, #050510 70%, #000 100%);
}
.starfield-stars {
  position: absolute;
  inset: 0;
  overflow: hidden;
}
.starfield-stars .star {
  position: absolute;
  width: 3px;
  height: 3px;
  background: #fff;
  border-radius: 50%;
  box-shadow: 0 0 6px 1px rgba(255,255,255,0.6);
  transform: scale(var(--scale, 1));
  animation: starfield-twinkle 2.5s ease-in-out infinite;
  opacity: 0.3;
}
.starfield-stars .star:nth-child(3n) {
  width: 2px;
  height: 2px;
  opacity: 0.5;
}
.starfield-stars .star:nth-child(5n) {
  width: 4px;
  height: 4px;
  box-shadow: 0 0 8px 2px rgba(200,220,255,0.7);
  opacity: 0.4;
}
.starfield-launch-zone {
  position: absolute;
  top: 5%;
  left: 50%;
  width: 180px;
  height: 180px;
  transform: translateX(-50%);
  pointer-events: none;
}
.starfield-loader {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 54px;
  height: 54px;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  background:
    radial-gradient(circle at 32% 30%, rgba(245, 248, 255, 0.85), rgba(199, 206, 220, 0.55) 45%, rgba(120, 130, 145, 0.35) 75%, rgba(80, 88, 99, 0.25) 100%);
  border: 1px solid rgba(188, 198, 214, 0.45);
  box-shadow:
    inset 0 0 18px rgba(236, 241, 255, 0.26),
    0 0 28px rgba(184, 194, 224, 0.35);
  opacity: 0.8;
}
.starfield-loader::after {
  content: '';
  position: absolute;
  inset: -6px;
  border-radius: 50%;
  border: 2px solid rgba(190, 200, 220, 0.35);
  border-top-color: rgba(240, 245, 255, 0.78);
  animation: starfield-loader-spin 2.4s linear infinite;
}
.starfield-launch {
  position: absolute;
  inset: 0;
  overflow: visible;
  pointer-events: none;
}
.starfield-launch .launch-star {
  position: absolute;
  left: 50%;
  top: 50%;
  width: 2px;
  height: 2px;
  border-radius: 50%;
  background: rgba(228, 236, 255, 0.95);
  opacity: 0;
  box-shadow: 0 0 6px rgba(205, 220, 255, 0.95);
  transform: translate(-50%, -50%);
  animation: starfield-launch var(--duration, 2.2s) ease-out var(--delay, 0s) infinite;
}
.starfield-launch .launch-star::after {
  content: '';
  position: absolute;
  left: 50%;
  top: 50%;
  width: 14px;
  height: 1px;
  transform: translate(-100%, -50%);
  background: linear-gradient(90deg, rgba(182, 204, 245, 0), rgba(182, 204, 245, 0.5) 70%, rgba(235, 242, 255, 0.9));
  border-radius: 999px;
  opacity: 0.75;
}
@keyframes starfield-twinkle {
  0%, 100% { opacity: 0.25; transform: scale(var(--scale, 1)); }
  50% { opacity: 0.9; transform: scale(calc(var(--scale, 1) * 1.2)); }
}
@keyframes starfield-loader-spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}
@keyframes starfield-launch {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%);
  }
  16% {
    opacity: 1;
    transform: translate(-50%, -50%);
  }
  100% {
    opacity: 0;
    transform: translate(calc(-50% + var(--dx, 0px)), calc(-50% + var(--dy, 180px)));
  }
}
.starfield-title {
  position: relative;
  z-index: 2;
  font-size: 1.5rem;
  font-weight: 600;
  color: rgba(255,255,255,0.9);
  text-shadow: 0 0 20px rgba(150,180,255,0.5);
  letter-spacing: 0.08em;
  animation: starfield-title-in 1.2s ease-out;
}
@keyframes starfield-title-in {
  0% { opacity: 0; transform: scale(0.9); }
  100% { opacity: 1; transform: scale(1); }
}
.tabs-row { display: flex; align-items: center; justify-content: space-between; padding: 8px; border-bottom: 1px solid var(--vscode-widget-border); flex-shrink: 0; gap: 8px; }
.tabs { display: flex; gap: 4px; align-items: center; flex-wrap: wrap; flex: 1; min-width: 0; }
.tabs-actions { position: relative; flex-shrink: 0; display: flex; gap: 6px; align-items: center; }
.clear-chat-btn { padding: 6px 12px; cursor: pointer; border-radius: 4px; background: var(--vscode-input-background); border: 1px solid var(--vscode-input-border); font-size: inherit; color: var(--vscode-foreground); }
.clear-chat-btn:hover { background: var(--vscode-list-hoverBackground); }
.tab-history { padding: 6px 12px; cursor: pointer; border-radius: 4px; background: var(--vscode-input-background); border: 1px solid transparent; font-size: inherit; color: var(--vscode-foreground); }
.tab-history:hover { background: var(--vscode-list-hoverBackground); }
.history-dropdown { display: none; position: absolute; top: 100%; right: 0; margin-top: 4px; min-width: 220px; max-height: 320px; overflow-y: auto; background: var(--vscode-dropdown-background); border: 1px solid var(--vscode-dropdown-border); border-radius: 6px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 100; }
.history-dropdown.visible { display: block; }
.history-item { display: flex; align-items: center; justify-content: space-between; gap: 8px; padding: 8px 12px; border-bottom: 1px solid var(--vscode-widget-border); }
.history-item:last-child { border-bottom: none; }
.history-item-name { flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.history-item-actions { display: flex; gap: 4px; flex-shrink: 0; }
.history-item-btn { padding: 4px 8px; font-size: 12px; border-radius: 4px; cursor: pointer; border: 1px solid var(--vscode-button-border); background: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground); }
.history-item-btn:hover { background: var(--vscode-button-secondaryHoverBackground); }
.history-item-btn.delete { background: transparent; color: var(--vscode-errorForeground); border-color: var(--vscode-errorForeground); }
.history-item-btn.delete:hover { background: var(--vscode-errorForeground); color: var(--vscode-editor-background); }
.tab-wrap { display: inline-flex; align-items: center; border-radius: 4px; border: 1px solid transparent; background: var(--vscode-input-background); }
.tab-wrap:hover { background: var(--vscode-list-hoverBackground); }
.tab-wrap.active { border-color: var(--vscode-focusBorder); }
.tab-wrap.tab-llm-only { border-left: 3px solid var(--vscode-errorForeground, #f14c4c); }
.tab-wrap.tab-llm-only.active { border-color: var(--vscode-errorForeground, #f14c4c); }
.tab-wrap .tab { padding: 6px 4px 6px 12px; cursor: pointer; border: none; background: transparent; border-radius: 0; font-size: inherit; color: var(--vscode-foreground); }
.tab-wrap .tab-close { padding: 6px 8px; cursor: pointer; border: none; background: transparent; color: var(--vscode-foreground); font-size: 1.2em; line-height: 1; border-radius: 0; opacity: 0.7; }
.tab-wrap .tab-close:hover { opacity: 1; }
.tab-new { padding: 6px 12px; cursor: pointer; border-radius: 4px; background: var(--vscode-input-background); border: 1px solid transparent; font-size: inherit; color: var(--vscode-foreground); font-weight: bold; }
.tab-new:hover { background: var(--vscode-list-hoverBackground); }
.container { display: flex; flex-direction: column; flex: 1; min-height: 0; }
.wrapper { display: flex; flex-direction: column; height: 100vh; min-height: 0; }
.panel-body { flex: 1; min-height: 0; overflow-y: auto; display: flex; flex-direction: column; }
.messages {
  flex: 1;
  min-height: 0;
  padding: 8px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  overflow-y: auto;
}
.message { padding: 10px 14px; border-radius: 10px; max-width: 85%; }
.message.user { background: var(--vscode-input-background); border: 1px solid var(--vscode-input-border); align-self: flex-end; }
.message.assistant { background: var(--vscode-textBlockQuote-background); border: 1px solid var(--vscode-focusBorder, #007acc); border-left-width: 4px; align-self: flex-start; }
.message.message-error { border-color: var(--vscode-errorForeground, #f14c4c); }
.message-content.typing-indicator { color: var(--vscode-descriptionForeground); font-style: italic; }
.message-retry-btn { margin-top: 8px; padding: 4px 12px; font-size: 12px; border-radius: 4px; cursor: pointer; border: 1px solid var(--vscode-button-border); background: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground); }
.message-retry-btn:hover { background: var(--vscode-button-secondaryHoverBackground); }
.message-content { white-space: pre-wrap; word-break: break-word; }
.message-text { white-space: pre-wrap; word-break: break-word; }
.message-text p { margin: 0.5em 0; }
.message-content code, .message-text code { background: var(--vscode-textCodeBlock-background); padding: 2px 6px; border-radius: 4px; font-size: 0.9em; color: var(--vscode-textPreformat-foreground, var(--vscode-editor-foreground)); }
.message-text strong { font-weight: 700; color: var(--vscode-editor-foreground); }
.message-text em { font-style: italic; color: var(--vscode-descriptionForeground); }
.message-text .msg-h1 { font-size: 1.25em; font-weight: 700; margin: 0.75em 0 0.35em; color: var(--vscode-symbolIcon-color, var(--vscode-foreground)); }
.message-text .msg-h2 { font-size: 1.1em; font-weight: 600; margin: 0.6em 0 0.3em; color: var(--vscode-charts-blue, #3794ff); }
.message-text .msg-h3 { font-size: 1.05em; font-weight: 600; margin: 0.5em 0 0.25em; color: var(--vscode-charts-purple, #a371f7); }
.message-text .msg-blockquote { margin: 0.5em 0; padding: 0.4em 0 0.4em 12px; border-left: 3px solid var(--vscode-charts-yellow, #dcdcaa); color: var(--vscode-descriptionForeground); background: var(--vscode-editor-inactiveSelectionBackground); border-radius: 0 4px 4px 0; }
.message-text .msg-inline-code { background: var(--vscode-textCodeBlock-background); padding: 2px 6px; border-radius: 4px; font-family: var(--vscode-editor-font-family, monospace); font-size: 0.9em; color: var(--vscode-textPreformat-foreground); }
.message-text .msg-num { color: var(--vscode-charts-blue, #3794ff); font-weight: 600; }
.message-text .msg-bullet { color: var(--vscode-charts-green, #89d185); margin-right: 4px; }
.message-text ul, .message-text ol { margin: 0.5em 0; padding-left: 1.5em; }
.message-text li { margin: 0.25em 0; }
.code-preview-block { margin-top: 12px; border: 1px solid var(--vscode-panel-border); border-radius: 6px; overflow: hidden; background-color: var(--vscode-textCodeBlock-background); }
.code-block-header { display: block; padding: 8px 12px; min-height: 20px; font-size: 12px; font-weight: 600; color: var(--vscode-foreground); border-bottom: 1px solid var(--vscode-panel-border); background-color: var(--vscode-textBlockQuote-background); box-sizing: border-box; }
.code-block-scroll { margin-top: 0; padding: 12px; max-height: 360px; overflow-y: auto; overflow-x: auto; user-select: text; border: 1px solid var(--vscode-input-border); border-radius: 4px; background-color: var(--vscode-editor-background); }
.code-block-scroll pre { margin: 0; padding: 0; font-family: var(--vscode-editor-font-family, Consolas, Monaco, Courier New, monospace); font-size: var(--vscode-editor-font-size, 14px); line-height: 1.5; color: var(--vscode-editor-foreground); white-space: pre-wrap; word-wrap: break-word; }
.code-preview-actions { display: flex; gap: 8px; padding: 8px 12px; background-color: var(--vscode-textBlockQuote-background); border-top: 1px solid var(--vscode-panel-border); }
.code-copy-btn { padding: 4px 12px; font-size: 12px; border: 1px solid var(--vscode-button-border); border-radius: 3px; cursor: pointer; background-color: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground); }
.code-copy-btn:hover { background-color: var(--vscode-button-secondaryHoverBackground); border-color: var(--vscode-focusBorder); }
.message-content ul, .message-content ol { margin: 0.5em 0; padding-left: 1.5em; }
.message-content li { margin: 0.25em 0; }
.attached-files {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
  padding: 4px 0 6px;
}
.attached-file-tag {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 8px 2px 10px;
  border-radius: 12px;
  font-size: 11px;
  background: var(--vscode-badge-background, rgba(100,120,160,0.25));
  color: var(--vscode-badge-foreground, var(--vscode-foreground));
  border: 1px solid var(--vscode-focusBorder, rgba(100,120,180,0.35));
  cursor: default;
  max-width: 100%;
  overflow: hidden;
}
.attached-file-tag .af-name {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 260px;
}
.attached-file-tag .af-range {
  color: var(--vscode-descriptionForeground);
  white-space: nowrap;
  flex-shrink: 0;
}
.attached-file-tag .af-remove {
  flex-shrink: 0;
  background: none;
  border: none;
  padding: 0 0 0 2px;
  cursor: pointer;
  color: var(--vscode-descriptionForeground);
  font-size: 13px;
  line-height: 1;
  opacity: 0.75;
}
.attached-file-tag .af-remove:hover { opacity: 1; color: var(--vscode-errorForeground); }
.file-insert-toast { padding: 6px 10px; margin-bottom: 6px; font-size: 12px; border-radius: 4px; background: var(--vscode-inputValidation-infoBackground); border: 1px solid var(--vscode-inputValidation-infoBorder); color: var(--vscode-foreground); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.diff-view { border-top: 1px solid var(--vscode-widget-border); padding: 8px; height: 280px; flex-shrink: 0; display: flex; flex-direction: column; background: var(--vscode-editor-background); }
.diff-view-header { font-size: 12px; font-weight: 600; margin-bottom: 4px; color: var(--vscode-foreground); }
.diff-view-summary { font-size: 11px; color: var(--vscode-descriptionForeground); margin-bottom: 8px; }
.diff-view-files { flex: 1; overflow-y: auto; min-height: 0; }
.diff-file-block { margin-bottom: 10px; }
.diff-file-title { font-size: 11px; margin-bottom: 4px; display: flex; align-items: center; gap: 8px; }
.diff-file-title .diff-file-path { color: var(--vscode-foreground); }
.diff-file-title .diff-badge { font-size: 10px; padding: 2px 6px; border-radius: 3px; font-weight: 600; }
.diff-badge-new { background: var(--vscode-editorSuggestWidget-highlightForeground, #89d185); color: var(--vscode-editor-background); }
.diff-badge-modified { background: var(--vscode-charts-blue, #3794ff); color: var(--vscode-editor-background); }
.diff-file-title .diff-open-file-btn { margin-left: auto; padding: 2px 8px; font-size: 11px; border-radius: 3px; cursor: pointer; border: 1px solid var(--vscode-button-border); background: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground); }
.diff-file-title .diff-open-file-btn:hover { background: var(--vscode-button-secondaryHoverBackground); }
.diff-file-content { margin: 0; padding: 6px 8px; font-size: 12px; line-height: 1.4; overflow-x: auto; background: var(--vscode-textCodeBlock-background); border-radius: 4px; white-space: pre; }
.diff-line { display: block; }
.diff-line.diff-same { color: var(--vscode-editor-foreground); }
.diff-line.diff-remove { background: rgba(255, 0, 0, 0.15); color: var(--vscode-editorError-foreground, #f14c4c); }
.diff-line.diff-add { background: rgba(0, 255, 0, 0.15); color: var(--vscode-editorSuggestWidget-highlightForeground, #89d185); }
.diff-view-actions { display: flex; gap: 8px; margin-top: 8px; flex-shrink: 0; }
.diff-apply-btn, .diff-reject-btn { padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; border: 1px solid; }
.diff-apply-btn { background: var(--vscode-button-background); color: var(--vscode-button-foreground); border-color: var(--vscode-button-border); }
.diff-apply-btn:hover { background: var(--vscode-button-hoverBackground); }
.diff-reject-btn { background: var(--vscode-input-background); color: var(--vscode-foreground); border-color: var(--vscode-input-border); }
.diff-reject-btn:hover { background: var(--vscode-list-hoverBackground); }
.input-container { flex-shrink: 0; padding: 8px; border-top: 1px solid var(--vscode-widget-border); background: var(--vscode-editor-background); }
.context-footer { font-size: 11px; color: var(--vscode-descriptionForeground); margin-top: 6px; min-height: 16px; }
.input-row { display: flex; gap: 8px; align-items: flex-end; min-height: 48px; }
.input-row textarea {
  flex: 1;
  min-height: 72px;
  max-height: 200px;
  resize: vertical;
  padding: 10px 12px;
  border: 1px solid var(--vscode-input-border);
  background: var(--vscode-input-background);
  color: var(--vscode-input-foreground);
  font-family: inherit;
  font-size: inherit;
  border-radius: 10px;
}
.input-row textarea:focus { outline: 2px solid var(--vscode-focusBorder); outline-offset: -1px; }
.send-btn {
  padding: 10px 18px;
  background: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
  border: none;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 500;
}
.send-btn:hover { background: var(--vscode-button-hoverBackground); }
.send-btn:focus { outline: 2px solid var(--vscode-focusBorder); outline-offset: 1px; }
.think-block { margin-bottom: 8px; border: 1px solid var(--vscode-widget-border); border-radius: 6px; overflow: hidden; background: var(--vscode-editor-inactiveSelectionBackground, rgba(128,128,128,0.08)); }
.think-summary { padding: 6px 10px; cursor: pointer; font-size: 12px; font-weight: 500; color: var(--vscode-descriptionForeground); user-select: none; list-style: none; display: flex; align-items: center; gap: 6px; }
.think-summary::before { content: "üß†"; font-size: 13px; }
.think-block[open] .think-summary::before { content: "üß†"; }
.think-body { padding: 8px 10px; font-size: 12px; line-height: 1.5; white-space: pre-wrap; color: var(--vscode-foreground); opacity: 0.85; border-top: 1px solid var(--vscode-widget-border); }

/* Plan card */
.plan-card { margin: 10px 0; border: 1px solid var(--vscode-focusBorder, rgba(100,140,255,0.4)); border-radius: 8px; overflow: hidden; background: var(--vscode-editor-inactiveSelectionBackground, rgba(80,100,180,0.08)); }
.plan-header { padding: 10px 12px 8px; border-bottom: 1px solid var(--vscode-widget-border); }
.plan-title { font-size: 13px; font-weight: 600; color: var(--vscode-foreground); }
.plan-steps { padding: 6px 0; }
.plan-step { display: grid; grid-template-columns: 20px 70px 1fr; gap: 6px; align-items: baseline; padding: 4px 12px; font-size: 12px; line-height: 1.4; }
.plan-step:hover { background: var(--vscode-list-hoverBackground, rgba(255,255,255,0.04)); }
.plan-step__num { color: var(--vscode-descriptionForeground); font-size: 11px; text-align: right; }
.plan-step__action { font-size: 10px; font-weight: 600; padding: 1px 5px; border-radius: 3px; text-align: center; }
.plan-step--modify .plan-step__action { background: rgba(100,160,255,0.18); color: #7ab0ff; }
.plan-step--create .plan-step__action { background: rgba(80,200,120,0.18); color: #6ecf8c; }
.plan-step--delete .plan-step__action { background: rgba(220,80,80,0.18); color: #e07070; }
.plan-step--rename .plan-step__action { background: rgba(220,170,60,0.18); color: #d4a840; }
.plan-step__file { color: var(--vscode-textLink-foreground, #7ab0ff); font-family: var(--vscode-editor-font-family, monospace); font-size: 11px; word-break: break-all; }
.plan-step__desc { color: var(--vscode-descriptionForeground); grid-column: 3; font-size: 11px; margin-top: 1px; }
.plan-notes { margin: 4px 12px 6px; font-size: 11px; color: var(--vscode-descriptionForeground); background: rgba(255,200,60,0.07); border-radius: 4px; padding: 5px 8px; }
.plan-actions { display: flex; gap: 8px; padding: 8px 12px 10px; border-top: 1px solid var(--vscode-widget-border); }
.plan-btn { padding: 5px 14px; border-radius: 5px; border: none; cursor: pointer; font-size: 12px; font-weight: 500; transition: opacity 0.15s; }
.plan-btn--confirm { background: var(--vscode-button-background); color: var(--vscode-button-foreground); }
.plan-btn--confirm:hover { opacity: 0.85; }
.plan-btn--reject { background: transparent; color: var(--vscode-descriptionForeground); border: 1px solid var(--vscode-widget-border); }
.plan-btn--reject:hover { background: rgba(255,255,255,0.06); }
